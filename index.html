<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>è–¬å‰¤è²»ç”¨è¨ˆç®—ã‚¢ãƒ—ãƒª v5.3ï¼ˆCSVèª­è¾¼æ”¹å–„ç‰ˆï¼‰</title>
    <style>
        /* ã‚¹ã‚¿ã‚¤ãƒ«è¨­å®š */
        *{box-sizing:border-box}
        body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans JP",sans-serif;margin:0;padding:16px;background:#fafafa;color:#333}
        h1{margin:0 0 12px;font-size:18px;color:#0a84ff}
        .card{background:#fff;border:1px solid #e5e5ea;border-radius:12px;padding:12px;margin:12px 0;box-shadow:0 1px 3px rgba(0,0,0,0.05)}
        .row{display:flex;gap:12px;flex-wrap:wrap}
        .col{flex:1 1 200px;min-width:200px}
        label{display:block;margin-bottom:4px;font-size:13px;font-weight:600;color:#666}
        input,select,button,textarea{width:100%;padding:10px;border:1px solid #d0d0d0;border-radius:10px;background:#fff;font-size:16px}
        button{background:#0a84ff;color:#fff;border:0;cursor:pointer;font-weight:600;transition:opacity 0.2s}
        button:hover{opacity:0.8}
        button.secondary{background:#f2f2f7;color:#111;border:1px solid #d0d0d0}
        button.danger{background:#ff3b30;color:#fff}
        button.ghost{background:#fff;color:#0a84ff;border:1px solid #0a84ff}
        .drug-row{border:1px dashed #d0d0d0;border-radius:10px;padding:12px;margin:10px 0;background:#fafbfc}
        .suggest{position:absolute;z-index:999;background:#fff;border:1px solid #d0d0d0;border-radius:10px;box-shadow:0 4px 12px rgba(0,0,0,.1);max-height:200px;overflow:auto;display:none;width:100%}
        .suggest-item{padding:8px 12px;cursor:pointer;border-bottom:1px solid #f0f0f0}
        .suggest-item:hover{background:#eef5ff}
        pre.readonly{white-space:pre-wrap;background:#f8f9fa;border:1px solid #eee;border-radius:10px;padding:12px;min-height:100px;font-size:14px;line-height:1.5}
        .status{padding:10px;border-radius:8px;font-size:13px;margin-top:8px;background:#e8f4fd;color:#0a84ff;border:1px solid #d1e9ff}
        @media (min-width:900px){ .layout{display:grid;grid-template-columns:1fr 1fr;gap:20px} }
    </style>
</head>
<body>

<h1>ğŸ¥ è–¬å‰¤è²»ç”¨è¨ˆç®—ã‚¢ãƒ—ãƒª v5.3</h1>

<div class="layout">
    <div class="panel-left">
        <div class="card">
            <label>åŸºæœ¬è¨­å®š</label>
            <div class="row">
                <div class="col"><label>ä½“é‡ (kg)</label><input type="number" id="weight" step="0.01" placeholder="5.0"></div>
                <div class="col"><label>æ—¥æ•°</label><input type="number" id="days" value="7"></div>
                <div class="col">
                    <label>å›æ•°/æ—¥</label>
                    <select id="timesPerDay">
                        <option value="1">SID (1å›)</option>
                        <option value="2" selected>BID (2å›)</option>
                        <option value="3">TID (3å›)</option>
                    </select>
                </div>
            </div>
            <div class="row" style="margin-top:10px">
                <div class="col">
                    <label>å‡¦æ–¹å½¢æ…‹</label>
                    <select id="globalForm">
                        <option value="TAB">éŒ å‰¤ (ãã®ã¾ã¾)</option>
                        <option value="POWDER">æ•£å‰¤ (éŒ å‰¤ã‚’ç²‰ç •)</option>
                    </select>
                </div>
                <div class="col">
                    <label>&nbsp;</label>
                    <label><input type="checkbox" id="bunpo" checked style="width:auto"> åˆ†åŒ…æ©Ÿä½¿ç”¨ (+20å††/åŒ…)</label>
                </div>
            </div>
        </div>

        <div class="card">
            <label>ğŸ’Š è–¬å‰¤å…¥åŠ›</label>
            <div id="tabletList"></div>
            <button id="addDrug" style="margin-top:10px">ï¼‹ è–¬å‰¤ã‚’è¿½åŠ </button>
        </div>

        <div class="card">
            <details open>
                <summary style="cursor:pointer; font-weight:bold;">ğŸ“¦ ãƒ‡ãƒ¼ã‚¿ç®¡ç† (CSV/ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ)</summary>
                <div style="margin-top:10px">
                    <label>ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨ã—ã¦ç¾åœ¨ã®å…¥åŠ›ã‚’ä¿å­˜</label>
                    <div class="row">
                        <input id="tplName" style="flex:2" placeholder="ä¾‹ï¼šä¸‹ç—¢æ­¢ã‚ã‚»ãƒƒãƒˆ">
                        <button id="saveTpl" style="flex:1">ä¿å­˜</button>
                    </div>
                    <label style="margin-top:10px">ä¿å­˜æ¸ˆã¿ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ</label>
                    <div class="row">
                        <select id="tplSelect" style="flex:2"></select>
                        <button id="loadTpl" class="secondary" style="flex:1">èª­è¾¼</button>
                    </div>
                    <hr style="margin:20px 0; border:0; border-top:1px solid #eee">
                    
                    <label>è–¬å‰¤ãƒã‚¹ã‚¿ãƒ¼ç™»éŒ² (CSV)</label>
                    <input type="file" id="csvInput" accept=".csv" style="display:none">
                    <button id="csvBtn" class="ghost">ğŸ“ CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦èª­ã¿è¾¼ã‚€</button>
                    <div id="csvStatus" class="status">è–¬å‰¤ãƒ‡ãƒ¼ã‚¿: 0ä»¶</div>
                    <p style="font-size:11px; color:#666; margin-top:5
